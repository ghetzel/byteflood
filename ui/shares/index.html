---
page:
  title: Shares
bindings:
- name: peers
  resource: :/api/peers
---
{{ $session := or .request.url.query.session `` }}
{{ $view := or .request.url.query.view `files` }}
{{ $share := or .request.url.query.name `` }}
{{ $path := or .request.url.query.path `` }}
<div class="col-md-2">
    <ul class="nav bf-nav-tree">
        <li class="nav-item">
          <span class="bf-nav-tree-title">Local</span>
          <script type="text/javascript" id="shares-list-local">
            $(function(){
              $.get('/shares/_peer_shares', function(data){
                $('#shares-list-local').replaceWith(data);
              });
            })
          </script>
        </li>
        {{ range .bindings.peers }}
        <li class="nav-item">
          <span class="bf-nav-tree-title">{{ .name }}</span>
          <script type="text/javascript" id="shares-list-{{ .session_id }}">
            $(function(){
              $.get('/shares/_peer_shares?session={{ .session_id }}', function(data){
                $('#shares-list-{{ .session_id }}').replaceWith(data);
              });
            })
          </script>
        </li>
        {{ end }}
    </ul>
</div>

<div class="col-md-10">
  <script type="text/javascript" id="share-browser">
    $(function(){
      $.get('/shares/_peer_browse_{{ $view }}?session={{ $session }}&name={{ $share }}&path={{ $path }}', function(data){
        $('#share-browser').replaceWith(data);
      });
    })
  </script>
</div>
